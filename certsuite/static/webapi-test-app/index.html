<!doctype html>
<html>
  <!--
      This Source Code Form is subject to the terms of the Mozilla Public
      License, v. 2.0. If a copy of the MPL was not distributed with this file,
      You can obtain one at http://mozilla.org/MPL/2.0/.
    -->
  <head>
    <meta charset=utf-8>
    <title></title>
    <script>
      var navList = [];
      var windowList = [];
      function getTheNames(obj, list) {
        while (obj) {
          for (var name of Object.getOwnPropertyNames(obj)) {
            //console.log(name);
            document.writeln(name+ "<br>");
            list.push(name);
          }
          obj = Object.getPrototypeOf(obj);
        }
      }

      getTheNames(navigator, navList);
      getTheNames(window, windowList);
      var results = {};
      results.navList = navList;
      results.windowList = windowList;
      var xmlHttp = null;
      xmlHttp = new XMLHttpRequest();
      xmlHttp.open( "POST", location.origin + "/webapi_results", true );
      xmlHttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
      xmlHttp.send("results=" + JSON.stringify(results));
      document.writeln("<h1>Done!</h1>");
      //TODO: post the lists to location.protocol + location.host + "/submit/webapi" or something
    </script>
  </head>
</html>
